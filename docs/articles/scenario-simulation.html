<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A scenario decision tree simulation • LTBIscreeningproject</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="A scenario decision tree simulation" />

<meta property="og:description" content="" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-vignette">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTBIscreeningproject</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/active-tb-imputation.html">Active TB progression estimation</a>
    </li>
    <li>
      <a href="../articles/combine_dectree_and_popmodel_output.html">Basic output plots</a>
    </li>
    <li>
      <a href="../articles/cost-effectiveness-analysis.html">Cost-effectiveness calculation</a>
    </li>
    <li>
      <a href="../articles/scenario-simulation.html">A scenario decision tree simulation</a>
    </li>
    <li>
      <a href="../articles/set-up.html">Basic example: model set-up</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      
<div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>A scenario decision tree simulation</h1>
                        <h4 class="author">Nathan Green</h4>
            
            <h4 class="date">2018-04-04</h4>
      
      

    </div>

    
    
<div class="contents">
<p>This document demonstrates running the screening, diagnosis and treatment decision tree model.</p>
<p>First, we need to attach the packages we’ll need. <code>treeSimR</code> is written by us too so this will need to be installed from GitHub.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(treeSimR)
<span class="kw">library</span>(LTBIscreeningproject)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(data.tree)
<span class="kw">library</span>(purrr)</code></pre></div>
<p>Load in data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;intervention_constants&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;LTBIscreeningproject&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;cost_effectivness_params&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;LTBIscreeningproject&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;scenario_parameters&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;LTBIscreeningproject&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;model_input_cohort.RData&quot;</span>)</code></pre></div>
<div id="intervention-specific-individual-level-data" class="section level2">
<h2>Intervention specific individual-level data</h2>
<p>According to the parameter values we specified in <code>interv</code> we first need to prepare the cohort data set to only include those individuals we’re interested in analysing.</p>
<p>Only use a single year cohort</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cohort &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(IMPUTED_sample,
                        issdt_year <span class="op">==</span><span class="st"> </span>interv<span class="op">$</span>year_cohort)</code></pre></div>
<p>EWNI stay long enough to be screened</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cohort &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(cohort,
                        date_exit_uk1_issdt.years <span class="op">&gt;=</span><span class="st"> </span>interv<span class="op">$</span>min_screen_length_of_stay)</code></pre></div>
<p>Only keep those inidiviuals that are screened <em>before</em> some other event</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (interv<span class="op">$</span>screen_with_delay) {
  cohort &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(cohort,
                          screen <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
}</code></pre></div>
<p>Do we include student in the screening programme?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (interv<span class="op">$</span>no_students) {
  cohort &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(cohort,
                          visatype2 <span class="op">!=</span><span class="st"> &quot;Students&quot;</span>)}</code></pre></div>
<p>Include individuals from ‘higher’ incidence countries only</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cohort &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(cohort,
                        who_prev_cat_Pareek2011 <span class="op">%in%</span><span class="st"> </span>interv<span class="op">$</span>incidence_grps_screen)</code></pre></div>
<p>Count numbers of TB cases</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n.exit_tb &lt;-
<span class="st">  </span>cohort <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(exituk_tb) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">count</span>()

n.uk_tb &lt;-
<span class="st">  </span>cohort <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(uk_tb) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">count</span>()


num_all_tb_cost &lt;-
<span class="st">  </span><span class="cf">if</span> (interv<span class="op">$</span>ENDPOINT_cost <span class="op">==</span><span class="st"> &quot;exit uk&quot;</span>) {
    n.uk_tb
  } <span class="cf">else</span> <span class="cf">if</span> (interv<span class="op">$</span>ENDPOINT_cost <span class="op">==</span><span class="st"> &quot;death&quot;</span>) {
    n.uk_tb <span class="op">+</span><span class="st"> </span>n.exit_tb}

num_all_tb_QALY &lt;-
<span class="st">  </span><span class="cf">if</span> (interv<span class="op">$</span>ENDPOINT_QALY <span class="op">==</span><span class="st"> &quot;exit uk&quot;</span>) {
    n.uk_tb
  } <span class="cf">else</span> <span class="cf">if</span> (interv<span class="op">$</span>ENDPOINT_QALY <span class="op">==</span><span class="st"> &quot;death&quot;</span>) {
    n.uk_tb <span class="op">+</span><span class="st"> </span>n.exit_tb}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(cohort, <span class="dt">file =</span> <span class="st">&quot;cohort.Rds&quot;</span>)</code></pre></div>
</div>
<div id="prepare-decision-tree" class="section level2">
<h2>Prepare decision tree</h2>
<p>Load input files. We have defined the decision tree using YAML syntax. We have a separate trees for cost and health. They have the same structure and probabilities but different values on the branches. We also create our own class.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">osNode.cost.fileName &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;LTBI_dtree-cost-symptoms.yaml&quot;</span>,
                                    <span class="dt">package =</span> <span class="st">&quot;LTBIscreeningproject&quot;</span>)

osNode.health.fileName &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;LTBI_dtree-QALYloss-symptoms.yaml&quot;</span>,
                                      <span class="dt">package =</span> <span class="st">&quot;LTBIscreeningproject&quot;</span>)

costeff.cost &lt;-<span class="st"> </span>treeSimR<span class="op">::</span><span class="kw">costeffectiveness_tree</span>(<span class="dt">yaml_tree =</span> osNode.cost.fileName)
osNode.cost &lt;-<span class="st"> </span>costeff.cost<span class="op">$</span>osNode

costeff.health &lt;-<span class="st"> </span>treeSimR<span class="op">::</span><span class="kw">costeffectiveness_tree</span>(<span class="dt">yaml_tree =</span> osNode.health.fileName)
osNode.health &lt;-<span class="st"> </span>costeff.health<span class="op">$</span>osNode</code></pre></div>
<pre><code>#&gt; Warning in treeSimR::costeffectiveness_tree(yaml_tree = &quot;LTBI_dtree-cost-symptoms.yaml&quot;): Check type of attributes. Should they be numeric rather than character?
#&gt; $osNode
#&gt;                                                  levelName distn    max    min       p  scale shape     type
#&gt; 1   LTBI screening cost                                     unif   0.00   0.00 1.00000     NA    NA  logical
#&gt; 2    ¦--(0,50]                                              unif   0.00   0.00 0.00000                chance
#&gt; 3    ¦   ¦--LTBI                                            unif   0.00   0.00 0.03000                chance
#&gt; 4    ¦   ¦   ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 5    ¦   ¦   °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 6    ¦   ¦       ¦--1-Sensitivity                           unif   0.00   0.00 0.16000              terminal
#&gt; 7    ¦   ¦       °--Sensitivity                             unif   0.00   0.00 0.84000                chance
#&gt; 8    ¦   ¦           ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 9    ¦   ¦           °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 10   ¦   ¦               ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 11   ¦   ¦               ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 12   ¦   ¦               ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 13   ¦   ¦               ¦   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 14   ¦   ¦               ¦   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 15   ¦   ¦               ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 16   ¦   ¦               ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 17   ¦   ¦               ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 18   ¦   ¦               ¦       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 19   ¦   ¦               ¦       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 20   ¦   ¦               ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 21   ¦   ¦               °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 22   ¦   ¦                   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 23   ¦   ¦                   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 24   ¦   ¦                   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 25   ¦   ¦                   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 26   ¦   ¦                   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 27   ¦   ¦                   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 28   ¦   ¦                       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 29   ¦   ¦                       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 30   ¦   ¦                       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 31   ¦   ¦                       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 32   ¦   °--non-LTBI                                        unif   0.00   0.00 0.97000                chance
#&gt; 33   ¦       ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 34   ¦       °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 35   ¦           ¦--Specificity                             unif   0.00   0.00 0.99000              terminal
#&gt; 36   ¦           °--1-Specificity                           unif   0.00   0.00 0.01000                chance
#&gt; 37   ¦               ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 38   ¦               °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 39   ¦                   ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 40   ¦                   ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 41   ¦                   ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 42   ¦                   ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 43   ¦                   ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 44   ¦                   ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 45   ¦                   ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 46   ¦                   °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 47   ¦                       ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 48   ¦                       ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 49   ¦                       ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 50   ¦                       °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 51   ¦                           ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 52   ¦                           °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 53   ¦--(50,150]                                            unif   0.00   0.00 0.04000                chance
#&gt; 54   ¦   ¦--LTBI                                            unif   0.00   0.00 0.03000                chance
#&gt; 55   ¦   ¦   ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 56   ¦   ¦   °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 57   ¦   ¦       ¦--1-Sensitivity                           unif   0.00   0.00 0.16000              terminal
#&gt; 58   ¦   ¦       °--Sensitivity                             unif   0.00   0.00 0.84000                chance
#&gt; 59   ¦   ¦           ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 60   ¦   ¦           °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 61   ¦   ¦               ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 62   ¦   ¦               ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 63   ¦   ¦               ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 64   ¦   ¦               ¦   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 65   ¦   ¦               ¦   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 66   ¦   ¦               ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 67   ¦   ¦               ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 68   ¦   ¦               ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 69   ¦   ¦               ¦       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 70   ¦   ¦               ¦       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 71   ¦   ¦               ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 72   ¦   ¦               °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 73   ¦   ¦                   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 74   ¦   ¦                   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 75   ¦   ¦                   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 76   ¦   ¦                   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 77   ¦   ¦                   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 78   ¦   ¦                   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 79   ¦   ¦                       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 80   ¦   ¦                       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 81   ¦   ¦                       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 82   ¦   ¦                       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 83   ¦   °--non-LTBI                                        unif   0.00   0.00 0.97000                chance
#&gt; 84   ¦       ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 85   ¦       °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 86   ¦           ¦--Specificity                             unif   0.00   0.00 0.99000              terminal
#&gt; 87   ¦           °--1-Specificity                           unif   0.00   0.00 0.01000                chance
#&gt; 88   ¦               ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 89   ¦               °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 90   ¦                   ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 91   ¦                   ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 92   ¦                   ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 93   ¦                   ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 94   ¦                   ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 95   ¦                   ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 96   ¦                   ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 97   ¦                   °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 98   ¦                       ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 99   ¦                       ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 100  ¦                       ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 101  ¦                       °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 102  ¦                           ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 103  ¦                           °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 104  ¦--(150,250]                                           unif   0.00   0.00 0.16000                chance
#&gt; 105  ¦   ¦--LTBI                                            unif   0.00   0.00 0.03000                chance
#&gt; 106  ¦   ¦   ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 107  ¦   ¦   °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 108  ¦   ¦       ¦--1-Sensitivity                           unif   0.00   0.00 0.16000              terminal
#&gt; 109  ¦   ¦       °--Sensitivity                             unif   0.00   0.00 0.84000                chance
#&gt; 110  ¦   ¦           ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 111  ¦   ¦           °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 112  ¦   ¦               ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 113  ¦   ¦               ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 114  ¦   ¦               ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 115  ¦   ¦               ¦   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 116  ¦   ¦               ¦   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 117  ¦   ¦               ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 118  ¦   ¦               ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 119  ¦   ¦               ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 120  ¦   ¦               ¦       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 121  ¦   ¦               ¦       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 122  ¦   ¦               ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 123  ¦   ¦               °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 124  ¦   ¦                   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 125  ¦   ¦                   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 126  ¦   ¦                   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 127  ¦   ¦                   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 128  ¦   ¦                   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 129  ¦   ¦                   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 130  ¦   ¦                       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 131  ¦   ¦                       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 132  ¦   ¦                       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 133  ¦   ¦                       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 134  ¦   °--non-LTBI                                        unif   0.00   0.00 0.97000                chance
#&gt; 135  ¦       ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 136  ¦       °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 137  ¦           ¦--Specificity                             unif   0.00   0.00 0.99000              terminal
#&gt; 138  ¦           °--1-Specificity                           unif   0.00   0.00 0.01000                chance
#&gt; 139  ¦               ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 140  ¦               °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 141  ¦                   ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 142  ¦                   ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 143  ¦                   ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 144  ¦                   ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 145  ¦                   ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 146  ¦                   ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 147  ¦                   ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 148  ¦                   °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 149  ¦                       ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 150  ¦                       ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 151  ¦                       ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 152  ¦                       °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 153  ¦                           ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 154  ¦                           °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 155  ¦--(250,350]                                           unif   0.00   0.00 0.60000                chance
#&gt; 156  ¦   ¦--LTBI                                            unif   0.00   0.00 0.03000                chance
#&gt; 157  ¦   ¦   ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 158  ¦   ¦   °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 159  ¦   ¦       ¦--1-Sensitivity                           unif   0.00   0.00 0.16000              terminal
#&gt; 160  ¦   ¦       °--Sensitivity                             unif   0.00   0.00 0.84000                chance
#&gt; 161  ¦   ¦           ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 162  ¦   ¦           °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 163  ¦   ¦               ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 164  ¦   ¦               ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 165  ¦   ¦               ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 166  ¦   ¦               ¦   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 167  ¦   ¦               ¦   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 168  ¦   ¦               ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 169  ¦   ¦               ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 170  ¦   ¦               ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 171  ¦   ¦               ¦       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 172  ¦   ¦               ¦       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 173  ¦   ¦               ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 174  ¦   ¦               °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 175  ¦   ¦                   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 176  ¦   ¦                   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 177  ¦   ¦                   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 178  ¦   ¦                   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 179  ¦   ¦                   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 180  ¦   ¦                   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 181  ¦   ¦                       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 182  ¦   ¦                       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 183  ¦   ¦                       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 184  ¦   ¦                       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 185  ¦   °--non-LTBI                                        unif   0.00   0.00 0.97000                chance
#&gt; 186  ¦       ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 187  ¦       °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 188  ¦           ¦--Specificity                             unif   0.00   0.00 0.99000              terminal
#&gt; 189  ¦           °--1-Specificity                           unif   0.00   0.00 0.01000                chance
#&gt; 190  ¦               ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 191  ¦               °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 192  ¦                   ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 193  ¦                   ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 194  ¦                   ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 195  ¦                   ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 196  ¦                   ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 197  ¦                   ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 198  ¦                   ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 199  ¦                   °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 200  ¦                       ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 201  ¦                       ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 202  ¦                       ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 203  ¦                       °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 204  ¦                           ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 205  ¦                           °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 206  °--(350,1e+05]                                         unif   0.00   0.00 0.20000                chance
#&gt; 207      ¦--LTBI                                            unif   0.00   0.00 0.03000                chance
#&gt; 208      ¦   ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 209      ¦   °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 210      ¦       ¦--1-Sensitivity                           unif   0.00   0.00 0.16000              terminal
#&gt; 211      ¦       °--Sensitivity                             unif   0.00   0.00 0.84000                chance
#&gt; 212      ¦           ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 213      ¦           °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 214      ¦               ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 215      ¦               ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 216      ¦               ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 217      ¦               ¦   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 218      ¦               ¦   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 219      ¦               ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 220      ¦               ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 221      ¦               ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 222      ¦               ¦       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 223      ¦               ¦       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 224      ¦               ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 225      ¦               °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 226      ¦                   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 227      ¦                   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 228      ¦                   ¦   ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 229      ¦                   ¦   ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 230      ¦                   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 231      ¦                   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 232      ¦                       ¦--Complete Treatment      unif 842.45 511.69 0.80000                chance
#&gt; 233      ¦                       ¦   ¦--Effective           unif   0.00   0.00 0.90000              terminal
#&gt; 234      ¦                       ¦   °--Not Effective       unif   0.00   0.00 0.10000              terminal
#&gt; 235      ¦                       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 236      °--non-LTBI                                        unif   0.00   0.00 0.97000                chance
#&gt; 237          ¦--Not Agree to Screen                         unif   0.00   0.00 0.40000              terminal
#&gt; 238          °--Agree to Screen                             unif 106.00  50.00 0.60000                chance
#&gt; 239              ¦--Specificity                             unif   0.00   0.00 0.99000              terminal
#&gt; 240              °--1-Specificity                           unif   0.00   0.00 0.01000                chance
#&gt; 241                  ¦--Not Start Treatment                 unif   0.00   0.00 0.30000              terminal
#&gt; 242                  °--Start Treatment                     unif   0.00   0.00 0.70000                chance
#&gt; 243                      ¦--Symptoms Hepatotoxicity        gamma     NA     NA 0.00245 87.889 6.679   chance
#&gt; 244                      ¦   ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 245                      ¦   ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 246                      ¦   ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 247                      ¦   °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 248                      ¦       ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 249                      ¦       °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 250                      °--Not Symptoms Hepatotoxicity     unif   0.00   0.00 0.99755                chance
#&gt; 251                          ¦--Symptoms Nausea            gamma     NA     NA 0.14300     13     5   chance
#&gt; 252                          ¦   ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 253                          ¦   °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 254                          °--Not Symptoms Nausea         unif   0.00   0.00 0.85700                chance
#&gt; 255                              ¦--Complete Treatment      unif 842.45 511.69 0.80000              terminal
#&gt; 256                              °--Not Complete Treatment  unif 140.41  85.24 0.20000              terminal
#&gt; 
#&gt; $data
#&gt; $data$data_prob
#&gt; [1] NA
#&gt; 
#&gt; $data$data_val
#&gt; [1] NA
#&gt; 
#&gt; 
#&gt; attr(,&quot;details&quot;)
#&gt; [1] &quot;&quot;
#&gt; attr(,&quot;class&quot;)
#&gt; [1] &quot;costeffectiveness_object&quot; &quot;list&quot;</code></pre>
<p>Create look-up tables using the cohort data to give proportion in each incidence in country of origin and the probability of LTBI for each of these.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">who_levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;(0,50]&quot;</span>, <span class="st">&quot;(50,150]&quot;</span>, <span class="st">&quot;(150,250]&quot;</span>, <span class="st">&quot;(250,350]&quot;</span>, <span class="st">&quot;(350,1e+05]&quot;</span>)

p_incid_grp &lt;-<span class="st"> </span>miscUtilities<span class="op">::</span><span class="kw">prop_table</span>(cohort<span class="op">$</span>who_prev_cat_Pareek2011)

pLatentTB.who &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">who_prev_cat_Pareek2011 =</span> <span class="kw">names</span>(p_incid_grp),
                            <span class="dt">LTBI =</span> <span class="kw">c</span>(<span class="fl">0.03</span>, <span class="fl">0.13</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>))</code></pre></div>
<p>Then insert these probabilities in to the decision tree</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(who_levels)) {
  
  osNode.cost<span class="op">$</span><span class="kw">Set</span>(<span class="dt">p =</span> p_incid_grp[i],
                  <span class="dt">filterFun =</span> <span class="cf">function</span>(x) x<span class="op">$</span>name <span class="op">==</span><span class="st"> </span>who_levels[i])
  
  osNode.health<span class="op">$</span><span class="kw">Set</span>(<span class="dt">p =</span> p_incid_grp[i],
                    <span class="dt">filterFun =</span> <span class="cf">function</span>(x) x<span class="op">$</span>name <span class="op">==</span><span class="st"> </span>who_levels[i])
}

<span class="cf">for</span> (i <span class="cf">in</span> who_levels) {
  
  pLTBI &lt;-<span class="st"> </span><span class="kw">subset</span>(pLatentTB.who,
                  who_prev_cat_Pareek2011 <span class="op">==</span><span class="st"> </span>i,
                  <span class="dt">select =</span> LTBI)
  
  osNode.cost<span class="op">$</span><span class="kw">Set</span>(<span class="dt">p =</span> pLTBI,
                  <span class="dt">filterFun =</span> <span class="cf">function</span>(x) x<span class="op">$</span>pathString <span class="op">==</span><span class="st"> </span>miscUtilities<span class="op">::</span><span class="kw">pastef</span>(<span class="st">&quot;LTBI screening cost&quot;</span>, i, <span class="st">&quot;LTBI&quot;</span>))
  osNode.health<span class="op">$</span><span class="kw">Set</span>(<span class="dt">p =</span> pLTBI,
                    <span class="dt">filterFun =</span> <span class="cf">function</span>(x) x<span class="op">$</span>pathString <span class="op">==</span><span class="st"> </span>miscUtilities<span class="op">::</span><span class="kw">pastef</span>(<span class="st">&quot;LTBI screening QALY loss&quot;</span>, i, <span class="st">&quot;LTBI&quot;</span>))
  
  osNode.cost<span class="op">$</span><span class="kw">Set</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pLTBI,
                  <span class="dt">filterFun =</span> <span class="cf">function</span>(x) x<span class="op">$</span>pathString <span class="op">==</span><span class="st"> </span>miscUtilities<span class="op">::</span><span class="kw">pastef</span>(<span class="st">&quot;LTBI screening cost&quot;</span>, i, <span class="st">&quot;non-LTBI&quot;</span>))
  osNode.health<span class="op">$</span><span class="kw">Set</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pLTBI,
                    <span class="dt">filterFun =</span> <span class="cf">function</span>(x) x<span class="op">$</span>pathString <span class="op">==</span><span class="st"> </span>miscUtilities<span class="op">::</span><span class="kw">pastef</span>(<span class="st">&quot;LTBI screening QALY loss&quot;</span>, i, <span class="st">&quot;non-LTBI&quot;</span>))
}</code></pre></div>
</div>
<div id="decision-tree-output" class="section level2">
<h2>Decision tree output</h2>
<p>Now we can run the decision tree model using the scenario parameter values, active TB cases, and cost and health decision tree objects.</p>
<p>A single scenario:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">decision_tree_cluster</span>(<span class="dt">parameters =</span> scenario_parameters[[<span class="dv">1</span>]],
                      <span class="dt">N.mc =</span> interv<span class="op">$</span>N.mc,
                      <span class="dt">n.uk_tb =</span> <span class="dv">10</span>, <span class="co">#as.numeric(n.uk_tb),</span>
                      <span class="dt">n.exit_tb =</span> <span class="dv">10</span>, <span class="co">#as.numeric(n.exit_tb),</span>
                      <span class="dt">cost_dectree =</span> <span class="st">&quot;osNode_cost_2009.Rds&quot;</span>,
                      <span class="dt">health_dectree =</span> <span class="st">&quot;osNode_health_2009.Rds&quot;</span>)
<span class="co">#&gt; $mc_cost</span>
<span class="co">#&gt;  [1] 37.27940 36.37491 37.06578 36.67532 36.26612 36.40452 36.22418 36.55427 36.97845 37.68561</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mc_health</span>
<span class="co">#&gt;  [1] 4.806743e-06 5.340375e-06 5.137309e-06 5.309466e-06 4.995974e-06 4.651200e-06 5.618218e-06 5.200578e-06 5.229864e-06 4.938510e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_tb_screen_all</span>
<span class="co">#&gt;    sim       status  n</span>
<span class="co">#&gt; 1    1 disease-free  4</span>
<span class="co">#&gt; 2    1           tb 16</span>
<span class="co">#&gt; 3    2 disease-free  2</span>
<span class="co">#&gt; 4    2           tb 18</span>
<span class="co">#&gt; 5    3 disease-free  4</span>
<span class="co">#&gt; 6    3           tb 16</span>
<span class="co">#&gt; 7    4 disease-free  1</span>
<span class="co">#&gt; 8    4           tb 19</span>
<span class="co">#&gt; 9    5 disease-free  5</span>
<span class="co">#&gt; 10   5           tb 15</span>
<span class="co">#&gt; 11   6 disease-free  5</span>
<span class="co">#&gt; 12   6           tb 15</span>
<span class="co">#&gt; 13   7 disease-free  5</span>
<span class="co">#&gt; 14   7           tb 15</span>
<span class="co">#&gt; 15   8 disease-free  4</span>
<span class="co">#&gt; 16   8           tb 16</span>
<span class="co">#&gt; 17   9 disease-free  3</span>
<span class="co">#&gt; 18   9           tb 17</span>
<span class="co">#&gt; 19  10 disease-free  2</span>
<span class="co">#&gt; 20  10           tb 18</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $n_tb_screen_uk</span>
<span class="co">#&gt;    sim       status  n</span>
<span class="co">#&gt; 1    1 disease-free  1</span>
<span class="co">#&gt; 2    1           tb  9</span>
<span class="co">#&gt; 3    2 disease-free  4</span>
<span class="co">#&gt; 4    2           tb  6</span>
<span class="co">#&gt; 5    3 disease-free  2</span>
<span class="co">#&gt; 6    3           tb  8</span>
<span class="co">#&gt; 7    4 disease-free  0</span>
<span class="co">#&gt; 8    4           tb 10</span>
<span class="co">#&gt; 9    5 disease-free  0</span>
<span class="co">#&gt; 10   5           tb 10</span>
<span class="co">#&gt; 11   6 disease-free  1</span>
<span class="co">#&gt; 12   6           tb  9</span>
<span class="co">#&gt; 13   7 disease-free  1</span>
<span class="co">#&gt; 14   7           tb  9</span>
<span class="co">#&gt; 15   8 disease-free  0</span>
<span class="co">#&gt; 16   8           tb 10</span>
<span class="co">#&gt; 17   9 disease-free  4</span>
<span class="co">#&gt; 18   9           tb  6</span>
<span class="co">#&gt; 19  10 disease-free  0</span>
<span class="co">#&gt; 20  10           tb 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $p_LTBI_to_effectiveTx</span>
<span class="co">#&gt; (350,1e+05] </span>
<span class="co">#&gt;    0.108864 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $subset_pop</span>
<span class="co">#&gt;    LTBI_pre tests  positive    startTx completeTx      cured LTBI_post</span>
<span class="co">#&gt; 1 0.2868171   0.6 0.1488349 0.08930096 0.05358058 0.03122406 0.2555931</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $call</span>
<span class="co">#&gt; decision_tree_cluster(parameters = scenario_parameters[[1]], </span>
<span class="co">#&gt;     N.mc = interv$N.mc, n.uk_tb = 10, n.exit_tb = 10, cost_dectree = &quot;osNode_cost_2009.Rds&quot;, </span>
<span class="co">#&gt;     health_dectree = &quot;osNode_health_2009.Rds&quot;)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $N.mc</span>
<span class="co">#&gt; [1] 10</span></code></pre></div>
<p>Multiple scenarios:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(scenario_parameters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],
       decision_tree_cluster,
       <span class="dt">N.mc =</span> <span class="dv">1</span>,
       <span class="dt">n.uk_tb =</span> <span class="dv">10</span>, <span class="co">#as.numeric(n.uk_tb),</span>
       <span class="dt">n.exit_tb =</span> <span class="dv">10</span>, <span class="co">#as.numeric(n.exit_tb),</span>
       <span class="dt">cost_dectree =</span> <span class="st">&quot;osNode_cost_2009.Rds&quot;</span>,
       <span class="dt">health_dectree =</span> <span class="st">&quot;osNode_health_2009.Rds&quot;</span>)
<span class="co">#&gt; $`1`</span>
<span class="co">#&gt; $`1`$mc_cost</span>
<span class="co">#&gt; [1] 36.51917</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$mc_health</span>
<span class="co">#&gt; [1] 5.271375e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$n_tb_screen_all</span>
<span class="co">#&gt;   sim       status  n</span>
<span class="co">#&gt; 1   1 disease-free  2</span>
<span class="co">#&gt; 2   1           tb 18</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$n_tb_screen_uk</span>
<span class="co">#&gt;   sim       status n</span>
<span class="co">#&gt; 1   1 disease-free 1</span>
<span class="co">#&gt; 2   1           tb 9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$p_LTBI_to_effectiveTx</span>
<span class="co">#&gt; (350,1e+05] </span>
<span class="co">#&gt;    0.108864 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$subset_pop</span>
<span class="co">#&gt;    LTBI_pre tests  positive    startTx completeTx      cured LTBI_post</span>
<span class="co">#&gt; 1 0.2868171   0.6 0.1488349 0.08930096 0.05358058 0.03122406 0.2555931</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$call</span>
<span class="co">#&gt; FUN(parameters = X[[i]], N.mc = 1, n.uk_tb = 10, n.exit_tb = 10, </span>
<span class="co">#&gt;     cost_dectree = &quot;osNode_cost_2009.Rds&quot;, health_dectree = &quot;osNode_health_2009.Rds&quot;)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`1`$N.mc</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`</span>
<span class="co">#&gt; $`2`$mc_cost</span>
<span class="co">#&gt; [1] 44.03829</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$mc_health</span>
<span class="co">#&gt; [1] 7.074663e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$n_tb_screen_all</span>
<span class="co">#&gt;   sim       status  n</span>
<span class="co">#&gt; 1   1 disease-free  3</span>
<span class="co">#&gt; 2   1           tb 17</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$n_tb_screen_uk</span>
<span class="co">#&gt;   sim       status n</span>
<span class="co">#&gt; 1   1 disease-free 2</span>
<span class="co">#&gt; 2   1           tb 8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$p_LTBI_to_effectiveTx</span>
<span class="co">#&gt; (350,1e+05] </span>
<span class="co">#&gt;    0.145152 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$subset_pop</span>
<span class="co">#&gt;    LTBI_pre tests  positive   startTx completeTx      cured LTBI_post</span>
<span class="co">#&gt; 1 0.2868171   0.6 0.1488349 0.1190679 0.07144077 0.04163208 0.2451851</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$call</span>
<span class="co">#&gt; FUN(parameters = X[[i]], N.mc = 1, n.uk_tb = 10, n.exit_tb = 10, </span>
<span class="co">#&gt;     cost_dectree = &quot;osNode_cost_2009.Rds&quot;, health_dectree = &quot;osNode_health_2009.Rds&quot;)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`2`$N.mc</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`</span>
<span class="co">#&gt; $`3`$mc_cost</span>
<span class="co">#&gt; [1] 52.58395</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$mc_health</span>
<span class="co">#&gt; [1] 9.690061e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$n_tb_screen_all</span>
<span class="co">#&gt;   sim       status  n</span>
<span class="co">#&gt; 1   1 disease-free  6</span>
<span class="co">#&gt; 2   1           tb 14</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$n_tb_screen_uk</span>
<span class="co">#&gt;   sim       status n</span>
<span class="co">#&gt; 1   1 disease-free 1</span>
<span class="co">#&gt; 2   1           tb 9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$p_LTBI_to_effectiveTx</span>
<span class="co">#&gt; (350,1e+05] </span>
<span class="co">#&gt;     0.18144 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$subset_pop</span>
<span class="co">#&gt;    LTBI_pre tests  positive   startTx completeTx     cured LTBI_post</span>
<span class="co">#&gt; 1 0.2868171   0.6 0.1488349 0.1488349 0.08930096 0.0520401  0.234777</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$call</span>
<span class="co">#&gt; FUN(parameters = X[[i]], N.mc = 1, n.uk_tb = 10, n.exit_tb = 10, </span>
<span class="co">#&gt;     cost_dectree = &quot;osNode_cost_2009.Rds&quot;, health_dectree = &quot;osNode_health_2009.Rds&quot;)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`3`$N.mc</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul>
      <li><a href="#intervention-specific-individual-level-data">Intervention specific individual-level data</a></li>
      <li><a href="#prepare-decision-tree">Prepare decision tree</a></li>
      <li><a href="#decision-tree-output">Decision tree output</a></li>
      </ul>
    </div>
      </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nathan Green, <a href='https://www.rstudio.com'><img src='http://tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
